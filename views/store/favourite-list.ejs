<%- include('../partials/head') %>
</head>
<body class="bg-light">
  <%- include('../partials/nav') %>

  <main class="container py-5">
    <h2 class="text-center text-danger fw-bold mb-5 display-6">
      Here are your favourites:
    </h2>

    <div class="row g-4 justify-content-center">
      <% favouriteHomes.forEach((home, index) => { %>
        <% if (home) { %>
          <div class="col-12 col-sm-6 col-md-4 col-lg-3">
            <div class="card h-100 shadow-sm hover-shadow">
              <img 
                src="<%= home.photo %>" 
                class="card-img-top object-fit-cover img-clickable" 
                alt="<%= home.houseName %>"
                data-bs-toggle="modal"
                data-bs-target="#photoModal<%= index %>"
              >
              <div class="card-body d-flex flex-column">
                <h5 class="card-title fw-semibold mb-1"><%= home.houseName %></h5>
                <p class="text-muted small mb-3">
                  <i class="fas fa-map-marker-alt me-2 text-danger"></i><%= home.location %>
                </p>
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <span class="text-danger fw-bold">Rs <%= home.price %> / night</span>
                  <span class="text-warning small">‚≠ê <%= home.rating %></span>
                </div>
                <form action="/favourites/delete/<%= home._id %>" method="POST" class="mt-auto">
                  <button 
                    type="submit" 
                    class="btn btn-danger w-100"
                  >
                    Remove from favourite
                  </button>
                </form>
              </div>
            </div>
          </div>

          <!-- Modal for full-size image -->
          <div class="modal fade" id="photoModal<%= index %>" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg">
              <div class="modal-content">
                <div class="modal-header border-0">
                  <h5 class="modal-title"><%= home.houseName %></h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0">
                  <img src="<%= home.photo %>" class="img-fluid w-100" alt="<%= home.houseName %>">
                </div>
              </div>
            </div>
          </div>
        <% } %>
      <% }) %>
    </div>
  </main>

  <!-- Bootstrap JS Bundle CDN -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Font Awesome CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>

  <style>
    /* Hover shadow effect */
    .hover-shadow:hover {
      box-shadow: 0 .75rem 1.5rem rgba(0,0,0,.2);
      transition: box-shadow 0.3s ease-in-out;
    }
    /* Card image styling */
    .card-img-top {
      height: 250px;
      object-fit: cover;
      transition: transform 0.3s ease;
      cursor: pointer;
    }
    .card-img-top:hover {
      transform: scale(1.05);
    }
    .btn {
      border-radius: 0.75rem;
    }
  </style>
</body>
</html>
